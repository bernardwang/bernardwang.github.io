function initD3(){w=window.innerWidth,h=window.innerHeight,start=Date.now(),twinkle=function(t){var r=d3.select(t);r.attr("r",.5),setTimeout(function(){r.attr("r",1.2*Math.random()+1)},100)},ringInit=function(t){var r=Math.floor(Math.PI/(100*Math.random()+starDensity)*t.radius*Math.SQRT1_2),a=360/r;d3.select(this).selectAll("g").data(d3.range(r).map(function(){return t})).enter().append("svg:g").attr("transform",function(r,n){return"rotate("+n*(a-2+2*Math.random())+")translate("+t.radius+")"}).append("svg:circle").attr("r",1.2*Math.random()+1).attr("opacity",Math.random()).attr("fill",function(){return 100*Math.random()>99.5?"#ffff9b":"white"})},largeScreen=w>1300,ringRange=largeScreen?8:4,ringNum=largeScreen?170:110,starDensity=largeScreen?100:75,rings=[];for(var t=0;ringNum>t;t++)rings.push({radius:300*Math.random()*ringRange,speed:Math.random()*-.0015+-6e-4});svg=d3.select("body").append("svg:svg").attr("width",w).attr("height",h).append("svg:g").attr("transform","translate("+3*w/4+","+-h/8+")scale(1)"),ring=svg.selectAll("g").data(rings).enter().append("svg:g").each(ringInit)}function updateD3(){elapsed=Date.now()-start,rotate=function(t){return"rotate("+t.speed*elapsed+")"},ring.attr("transform",rotate),Math.random()>.3&&(stars=d3.selectAll("circle"),twinkle(stars[0][Math.floor(Math.random()*stars[0].length)])),setTimeout(updateD3,40)}var svg,rings,ring,twinkle,ringInit,ringRange,ringNum,starDensity,elapsed,rotate,stars,w,h,start,largeScreen;